[tool:pytest]
# Pytest Configuration for Backend Integration Tests
testpaths = __tests__/integration/backend
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Async support
asyncio_mode = auto

# Coverage settings
addopts = 
    --verbose
    --tb=short
    --strict-markers
    --strict-config
    --disable-warnings
    --cov=__tests__/integration/backend
    --cov-report=term-missing
    --cov-report=html:coverage-backend
    --cov-fail-under=80

# Test markers
markers =
    unit: Unit tests
    integration: Integration tests  
    contract: API contract tests
    auth: Authentication tests
    security: Security and malicious file tests
    rate_limit: Rate limiting tests
    slow: Slow running tests
    requires_backend: Tests that need backend server running
    requires_database: Tests that need database connection
    clerk_integration: Clerk authentication integration tests

# Filtering
filterwarnings =
    ignore::UserWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

# Parallel execution
# -n auto for pytest-xdist (if installed)

# Environment variables
env_files = 
    .env.integration.local
    .env.integration.staging  
    .env.integration.production

# Test discovery
collect_ignore = [
    "setup.py",
    "conftest.py"
]